+++
date = 2025-04-19
title = "Первые шаги с клавиатурой на ZMK"
author = "Иван Селезнёв"
tags = ["guide", "zmk"]
+++

В статье содержится руководство, которое поможет совершать поможет сделать первые шаги в освоении клавиатуры на ZMK. Прочитав статью пользователь научится: управлять питанием клавиатуры, подключать клавиатуру к нескольким устройствам и обновлять прошивку.


## Подключение клавиатуры

Шаг 1. Для начала включаем её, переключив физический тумблер в положение "On". 

![image](/images/zmk-keyboards/buttons.png)


Шаг 2. Далее половинки надо соединить между собой, для этого одновременно на обоих половинках нажимаем кнопку "Reset", находящуюся на дне.


Шаг 3. Когда клавиатура включена и половинки соединены можно переходить к подключению. Для начала, стоит убедиться что текущий профиль подключения очищен, нажав `&BT_CLR` (в раскладке по умолчанию клавиши управления профилем расположены на 3 слое, переключиться на него можно, зажав клавиши переключения на слои 1 и 2), это сбросит привязанные к профилю устройства. 

![image](/images/zmk-keyboards/sel_clr.png)

Шаг 4. Далее, для подключения к устройству по Bluetooth надо нажать клавишу выбора профиля, например `&BT_SEL 0`. 


Шаг 5. После нажатия клавиатура перейдёт в режим сопряжения и отобразится в списке доступных для подключения, выбираем её, и, вуаля, всё работает! 

![image](/images/zmk-keyboards/connect.png)


> **P.S.** Если клавиатура работает некорректно, например, с одной половинки нажатия клавиш не доходят до устройства, то стоит повторно провести процедуру соединения половинок, одновременно нажав клавишу `Reset` на обоих.


## Подключение к нескольким устройствам

Для беспроводного подключения клавиатура может запомнить до 5 устройств, каждое подключенное устройство привязывается к выбранному "профилю" после подключения. 

Для подключения ко второму устройству надо нажать клавишу `&BT_SEL 1`, клавиатура станет доступна к сопряжения, подключаемся к ней с устройства.

Чтобы снова подключиться к первому устройству нажимаем `&BT_SEL 0`, устройство автоматически увидит клавиатуру и подключится к ней. Аналогично можно подключить устройства к профилям 3, 4, 5.

![image](/images/zmk-keyboards/sel.png)


> Функция `&BT_SEL n` выполняет первичное подключение устройства, если профиль `n` ранее не был настроен, и подключение к устройству, если ранее оно было привязано к профилю `n`.


## Состояние батареи

Текущий заряд главной (по умолчанию левая) половинки отображается в ОС, в списке подключеных Bluetooth устройств. Состояние заряда второстепенной (по умолчанию правая) половинки увидеть не получится, в нормальных условиях эта половинка разряжается медленнее главной.

![image](/images/zmk-keyboards/power_level.png)


## Выключение клавиатуры

Выключить клавиатуру можно [переклчателем на задней стороне клавиатуры](#подключение-клавиатуры), переведя его в положение Off, а также выключение можно настроить непосредственно на клавишу клавиатуры, назначив на неё `&SOFT_OFF`. При нажатии на эту клавишу обе половинки клавиатуры переведутся в выключенное состояние, чтобы пробудить её, надо нажать кнопку `Reset` на нижней стороне клавиатуры.


## Переход в состояние сна

Спустя 10 минут бездействия клавиатура переходит в режим сна для экономии заряда. Для пробуждения из сна достаточно нажать любую клавишу, и клавиатура проснётся через пару секунд.


## Подключение по проводу

При подключении клавиатуры к устройству проводом, клавиатура автоматически начинает передавать данные по проводу. После отключения провода клавиатура вернётся в режим передачи данных по Bluetooth.

В ситуациях, когда клавиатура подзаряжается от одного устройства, но необходимо передавать данные в другое, можно нажать клавишу `&OUT_BLE`, это принудительно переведет клавиатуру в режим передачи по Bluetooth и данные будут отправляться в устройство, привязанное к текущему профилю.

![image](/images/zmk-keyboards/cables.png)


## Прошивка клавиатуры

Обновление прошивки клавиатуры происходит следующим образом:
1) Подключаем половинку клавиатуры по проводу;
2) Дважды нажимаем клавишу `Reset` на нижней стороне клавиатуры (пауза между нажатиями должна быть минимальной);
3) Аналогично с прошивкой клавиатур на QMK, в ПК определяется новый съемный диск, в него надо положить файл прошивки. 

**Важно!** Прошивки половинок имеют различия, и прошивать левую половинку надо файлом, название которого оканчивается на `left.uf2`, а правую половинку файлом, оканчивающимся на  `right.uf2`.

> Переводить клавиатуру в режим прошивки можно не только двойным нажатием `Reset`, это также можно делать нажатием клавиши `&bootloader`. Нажатие `&bootloader` переводит в режим прошивки только ту половинку, на которой была нажата.

Больше информации в документации ZMK: https://zmk.dev/docs

![image](/images/zmk-keyboards/velvet.jpg)